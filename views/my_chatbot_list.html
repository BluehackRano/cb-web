<!DOCTYPE html>
<html lang="kr">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<title>Title</title>
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
</head>
<body>
<header id="header">
	<div class="wrapper wrapper_header">
		<div class="top_01 top_common">
			<img id="logo" class="logo" src="../public/images/img-chatbrick-logo.png" alt="logo">

			<div class="top_01 top_user_profile_common">
				<img id="login_logo" class="login_logo" src="../public/images/test_img.png" alt="login_logo">
				<div id="login_name" class="login_name" name="login_name"><p id="login_name_text"></p></div>
				<img id="login_dropdown" class="login_dropdown" src="../public/images/btn-dropdown-down.png" alt="login_dropdown">
			</div>
		</div>

		<div class="top_02 top_common">
			<div class="top_02 title_area">
				<div id="title">MY CHATBOT</div>
			</div>
			<div id="context">
				<p>
					“MY CHATBOT”에서는 기존에 생성한 챗봇들 중에서 수정을 원하는 아이콘을 클릭하여 해당하는 챗봇의 설정을 수정할 수 있고,
					“CREATE BOT”을 클릭하여 새로운 챗봇을 생성할 수 있어요.
				</p>
			</div>
		</div>
	</div>
</header>

<div id="content">
	<div class="wrapper_section _my_chatbot_list_section">
		<section id="section_01">
			<div class="section_01 botlist" id="botlist">
				<!--<div id="my_bot">-->
				<!--<img src="http://localhost:63342/cb-web/dist/5fae83177ae663a55094e3b89b5255ee.png" id="bot_image" alt="bot image">-->
				<!--<div id="bot_name">BOT_01</div>-->
				<!--<div id="bot_context">내가 만든 HACKATHON BOT_01</div>-->
				<!--</div>-->
			</div>
		</section>
	</div>
</div>
<footer id="footer"></footer>

<script>
	var login_logo = $('#login_logo');
	var login_name = $('#login_name_text');
	var login_dropdown = $('#login_dropdown');
  var botlist = $('#botlist');
  var createMyBot = (`<div id="create_my_bot">` +
  `<img src="../public/images/img-create-bot-nor.png"+ id="bot_image" class="bot_image" alt="bot image">` +
  `<div class="bot_name">` + "CREATE BOT" + `</div>` +
  `</div>`);

  $.ajax({
    url : 'https://www.chatbrick.io/api/brick/',
    type : 'GET',
    async: false,
    crossDomain: true,
    xhrFields: { withCredentials: true },
    success : function(body, status, res) {
      console.log('body2=>' + JSON.stringify(body.facebook));
      console.log('fb_profile=>' + body.facebook.fb_profile);
      if (body.success) {

        login_logo.attr("src", body.facebook.fb_profile);
        login_name.text(body.facebook.fb_name);

        body.data.forEach(function (item, index, array) {

          var bot_img = "";
          switch (item.type) {
            case "hackathon":
              bot_img = "../public/images/img-hackathon.png";
              break;
            case "portfolio":
              bot_img = "../public/images/img-designer-portfolio-01.png";
              break;
            case "bricks":
              bot_img = "../public/images/img-bricks.png";
              break;
          }

          var myBot = (
            `<div id="my_bot`+index+`" class="my_bot">` +
            `<img src="` + bot_img + `"+ class="bot_image" alt="bot image">` +
            `<div class="bot_name">` + item.name + `</div>` +
            `<div class="bot_context">` + item.desc + `</div>` +
            `</div>`
          );

          botlist.append(myBot);

          $(document).on('click',"#my_bot"+index, function () {
            $(this).css('background-color', '#ffffff');
            //edit page
          });

          $("#my_bot"+index).on({
            mouseenter: function () {
              //stuff to do on mouse enter
              $(this).css('background-color', '#e7e7e7');
            },
            mouseleave: function () {
              //stuff to do on mouse leave
              $(this).css('background-color', '#f3f3f3');
            }
          });

          $("#my_bot"+index).click(function () {
						var itemId = body.data[index].id;
						console.log('itemId=>' + itemId);

						window.location.href = '/chatbot/edit?id='+itemId;
          });
        });
        botlist.append(createMyBot);
      } else {
        //not login
        // window.location.href  = 'https://www.chatbrick.io';
        // window.location.href = 'http://www.localhost:3000';
			}
    }
  });

  var create_my_bot = $('#create_my_bot');
  var my_bot = $('#my_bot');
  console.log(botlist);


  create_my_bot.click(function () {
    create_my_bot.css('background-color', '#ffffff');
    window.location.href = '/chatbot/create';
  });
  create_my_bot.hover(function () {
    create_my_bot.css('background-color', '#e7e7e7');
  }, function () {
    create_my_bot.css('background-color', '#f3f3f3');
  });

</script>
<!--<script type="text/javascript" src="/public/javascripts/my_chatbot_list.js"></script>-->
</body>
</html>