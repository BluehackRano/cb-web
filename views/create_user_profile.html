<!DOCTYPE html>
<html lang="kr" xmlns="http://www.w3.org/1999/html">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<title>Title</title>
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/bodymovin/4.8.0/bodymovin.min.js'></script>
</head>
<body>
<header id="header">
	<div class="wrapper wrapper_header">
		<div class="top_01 top_common">
			<img id="logo" class="logo" src="../public/images/img-chatbrick-logo.png" alt="logo">

			<div class="top_01 top_user_profile_common">
				<img id="login_logo" class="login_logo" src="../public/images/test_img.png" alt="login_logo">
				<div id="login_name" class="login_name" name="login_name"><p id="login_name_text"></p></div>
				<img id="login_dropdown" class="login_dropdown" src="../public/images/btn-dropdown-down.png" alt="login_dropdown">
			</div>
		</div>

		<div class="top_02 top_common">
			<div class="top_02 title_area">
				<div id="title">CREAT CHATBOT</div>
				<div id="sub_title">| 데이터 정보 입력하기</div>
			</div>
			<div id="context">
				<p>
					{{사용자가 선택한 세트}}에 {{사용자의 이름}}님의 데이터 정보를 입력하는 단계에요.
					SET별로 비어있는 항목을 입력하거나 기존의 데이터를 수정하여 보다 더
					{{사용자의 이름}}에 잘어울리는 챗봇으로 만들어보세요.
				</p>
			</div>
		</div>
	</div>
</header>

<div id="content">

	<!--프로필정보 영역-->
	<div class="wrapper_section _user_profile_section">
		<section id="section_01" class="_profile_section">
			<div class="content_title">
				<p>
					사용자 데이터 입력 _ 프로필정보 (PROFILE)
				</p>
			</div>

			<div class="wrapper_article _user_profile_wrapper">
				<article id="article_01" class="_article">

					<div class="wrapper">
						<div class="user_profile_photo_area">
							<img src="../public/images/bg-img-upload-01.png" id="profile_img" class="user_profile_img">
							<!--<div id="profile_img" class="user_profile_img">-->

							<div class="user_profile_photo_guild_area">
								<div class="user_profile_photo_title">
									PROFILE IMAGE
								</div>

								<div class="user_profile_photo_context">
									챗봇에서 사용될 프로필 이미지를 업로드해주세요.</br>
									( 권장 해상도 : 800 x 800 )
								</div>

								<div class="user_profile_photo_upload_btn">
									<label for="uploadBtn" class="btn_file">파일 업로드</label>
									<input type="file" id="uploadBtn" class="uploadBtn">
								</div>

								<div id="after_upload">
									<input id="file" type="file" class="imgeFile"/>
									<div id="after_upload_motify"><p>변경하기</p></div>
									<div id="after_upload_del"><p>제거하기</p></div>
								</div>
							</div>
						</div>

						<div class="user_profile_data_area">
							<div class="article_title_profile">
								이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_data_name" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
									전문분야를 입력해주세요
							</div>
							<input type="text" id="user_profile_data_professional" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
									거주국가 및 지역을 입력해주세요
							</div>
							<input type="text" id="user_profile_data_location" class="baseInputText_02" placeholder="페이스북에 등록한 거주 국가및 지역정보를 Default로 표현">

							<div class="article_title_profile" id="">
									나를 표현할 수 있는 URL(홈페이지, 링크드인, SNS 등)을 입력해주세요
							</div>
							<input type="text" id="user_profile_data_appeal" class="baseInputText_02" placeholder="자신을">

							<div class="article_title_profile">
									방문자가 연락할 수 있는 이메일 주소를 입력해주세요
							</div>
							<input type="text" id="user_profile_data_email" class="baseInputText_02" placeholder="자신을">
						</div>
					</div>
				</article>
			</div>
		</section>
	</div>

	<!--사용자 데이터 입력 영역-->
	<div class="wrapper_section _user_profile_section">
		<section id="section_02" class="_profile_section">
			<div class="content_title">
				<p>
					사용자 데이터 입력 _ 기본정보
				</p>
			</div>

			<div class="wrapper_article _user_profile_wrapper">
				<article id="article_02" class="_article">

					<div class="wrapper">
						<div class="user_profile_data_area">
							<div class="article_title_profile">
								챗봇에 방문하였을 때, 처음으로 보내는 메세지
							</div>
							<input type="text" id="user_profile_start_message_01" class="baseInputText_02 user_profile_start_message" placeholder="가나다">
							<input type="text" id="user_profile_start_message_02" class="baseInputText_02 user_profile_start_message" placeholder="가나다">
							<input type="text" id="user_profile_start_message_03" class="baseInputText_02 user_profile_start_message" placeholder="가나다">

							<div class="article_title_profile">
								방문자가 준비되지 않은 메세지를 보냈을 때, 보내는 메세지
							</div>
							<input type="text" id="user_profile_not_ready_mesage_01" class="baseInputText_02 user_profile_not_ready_mesage" placeholder="가나다">
							<input type="text" id="user_profile_not_ready_mesage_02" class="baseInputText_02 user_profile_not_ready_mesage" placeholder="가나다">
							<input type="text" id="user_profile_not_ready_mesage_03" class="baseInputText_02 user_profile_not_ready_mesage" placeholder="가나다">
						</div>
					</div>
				</article>
			</div>
		</section>
	</div>

	<!--업무경험 영역-->
	<div class="wrapper_section _user_profile_section">
		<section id="section_03" class="_profile_section">
			<div class="content_title">
				<p>
					사용자 데이터 입력 _ 업무경험 (WORK)
				</p>
			</div>

			<div class="wrapper_article _user_profile_wrapper">
				<article id="article_03" class="_article">

					<div class="wrapper">
						<div class="user_profile_data_area">
							<div class="article_title_profile">
								[01] 등록할 업무경험 회사의 이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_company_name_01" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[01] 등록할 업무경험 회사에서의 근무기간을 입력해주세요
							</div>
							<input type="text" id="user_profile_company_term_01" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[01] 등록할 업무경험 회사에서의 근무분야를 입력해주세요
							</div>
							<input type="text" id="user_profile_company_major_01" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[02] 등록할 업무경험 회사의 이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_company_name_02" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[02] 등록할 업무경험 회사에서의 근무기간을 입력해주세요
							</div>
							<input type="text" id="user_profile_company_term_02" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[02] 등록할 업무경험 회사에서의 근무분야를 입력해주세요
							</div>
							<input type="text" id="user_profile_company_major_02" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[03] 등록할 업무경험 회사의 이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_company_name_03" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[03] 등록할 업무경험 회사에서의 근무기간을 입력해주세요
							</div>
							<input type="text" id="user_profile_company_term_03" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[03] 등록할 업무경험 회사에서의 근무분야를 입력해주세요
							</div>
							<input type="text" id="user_profile_company_major_03" class="baseInputText_02" placeholder="가나다">
						</div>
					</div>
				</article>
			</div>
		</section>
	</div>

	<!--사용자 데이터 입력 영역-->
	<div class="wrapper_section _user_profile_section">
		<section id="section_04" class="_profile_section">
			<div class="content_title">
				<p>
					사용자 데이터 입력 _ 보유기술 및 능력 (SPECIALTIES)
				</p>
			</div>

			<div class="wrapper_article _user_profile_wrapper">
				<article id="article_04" class="_article">

					<div class="wrapper">
						<div class="user_profile_data_area">
							<div class="article_title_profile">
								[01] 등록할 보유기술 및 능력의 이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_skill_name_01" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[01] 등록할 보유기술 및 능력의  상세정보를 입력해주세요
							</div>
							<input type="text" id="user_profile_skill_info_01_1" class="baseInputText_02 user_profile_skill_info_01" placeholder="가나다">
							<input type="text" id="user_profile_skill_info_01_2" class="baseInputText_02 user_profile_skill_info_01" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[02] 등록할 보유기술 및 능력의 이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_skill_name_02" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[02] 등록할 보유기술 및 능력의  상세정보를 입력해주세요
							</div>
							<input type="text" id="user_profile_skill_info_02_1" class="baseInputText_02 user_profile_skill_info_02" placeholder="가나다">
							<input type="text" id="user_profile_skill_info_02_2" class="baseInputText_02 user_profile_skill_info_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[03] 등록할 보유기술 및 능력의 이름을 입력해주세요
							</div>
							<input type="text" id="user_profile_skill_name_03" class="baseInputText_02" placeholder="가나다">

							<div class="article_title_profile">
								[03] 등록할 보유기술 및 능력의  상세정보를 입력해주세요
							</div>
							<input type="text" id="user_profile_skill_info_03_1" class="baseInputText_02 user_profile_skill_info_03" placeholder="가나다">
							<input type="text" id="user_profile_skill_info_03_2" class="baseInputText_02 user_profile_skill_info_03" placeholder="가나다">
						</div>
					</div>
				</article>
			</div>
		</section>
	</div>

	<!--사용자 자기소개 영역-->
	<div class="wrapper_section _user_profile_section">
		<section id="section_05" class="_profile_section">
			<div class="content_title">
				<p>
					사용자 데이터 입력 _ 간략한 자기소개 (SUMMARY)
				</p>
			</div>

			<div class="wrapper_article _user_profile_wrapper">
				<article id="article_05" class="_article">

					<div class="wrapper">
						<div class="user_profile_data_area">
							<div class="article_title_profile">
								[01] 간략한 자기소개를 입력해주세요
							</div>
							<input type="text" id="user_profile_self_introduction_01_1" class="baseInputText_02 user_profile_self_introduction_01" placeholder="가나다">
							<input type="text" id="user_profile_self_introduction_01_2" class="baseInputText_02 user_profile_self_introduction_01" placeholder="가나다">
							<input type="text" id="user_profile_self_introduction_01_3" class="baseInputText_02 user_profile_self_introduction_01" placeholder="가나다">
							<input type="text" id="user_profile_self_introduction_01_4" class="baseInputText_02 user_profile_self_introduction_01" placeholder="가나다">
							<input type="text" id="user_profile_self_introduction_01_5" class="baseInputText_02 user_profile_self_introduction_01" placeholder="가나다">
						</div>
					</div>
				</article>
			</div>
		</section>
	</div>

	<!--사용자 포트폴리오 영역-->
	<div class="wrapper_section _user_profile_section" id="portfolio_endline">
		<section id="section_06" class="_profile_section">
			<div class="content_title">
				<p>
					사용자 데이터 입력 _ 포트폴리오 (PORTFOLIO)
				</p>
			</div>

			<div class="wrapper_article _user_profile_wrapper">
				<article id="article_06" class="_article">

					<div class="wrapper">
						<div class="user_profile_data_area">
							<div class="article_title_profile">
								[01] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_01" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[02] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_02" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[03] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_03" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[04] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_04" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[05] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_05" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[06] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_06" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[07] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_07" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[08] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_08" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[09] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_09" class="baseInputText_02" placeholder="가나다">
							<hr class="user_profile_line">

							<div class="article_title_profile">
								[10] 포트폴리오 URL (DRIBBBLE / BEHANCE)
							</div>
							<input type="text" id="user_profile_portfolio_10" class="baseInputText_02" placeholder="가나다">
						</div>

					</div>
				</article>
			</div>
		</section>
	</div>

	<!--디폴트 모양 팝업-->
	<div id="default_modal" class="modal">
		<!-- Modal content -->
		<div class="modal-content">

			<div class="modal_title">확인</div>
			<div class="modal_context">올바르지 않은 항목이 존재합니다. (미입력, 잘못입력된 항목)</div>
			<div id="modal_one_btn" class="modal_one_btn">
				<p>확인</p></div>
		</div>
	</div>

	<!--로그아웃 모양 팝업-->
	<div id="logout_modal" class="modal">
		<!-- Modal content -->
		<div class="modal-content">

			<div class="modal_title">로그아웃</div>
			<div class="modal_context">chatbrick에서 로그아웃하시겠습니까?</div>
			<div class="modal_brick_api_two_btn_area">
				<div id="modal_left_logout_btn" class="modal_left_btn">
					<p>아니요</p>
				</div>

				<div id="modal_right_logout_btn" class="modal_right_btn">
					<p>네</p>
				</div>
			</div>
		</div>
	</div>

	<!--디포폴 체크 모양 팝업-->
	<div id="lego_loading_modal" class="modal">
		<!-- Modal content -->
		<div class="modal-content">
			<div id="animationWindow"></div>
			<div class="modal_title" id="lego_loading_title">{{프로젝트명}} 포트폴리오</div>
			<div class="lego_loading_context_area">
				<div class="lego_loading_context" id="lego_loading_context_01">{{프로젝트명}}의 포트폴리오를 읽어오고 있어요.</div>
				<div class="lego_loading_context" id="lego_loading_context_02">지금 {{순서}}. {{포트폴리오명}}의 정보를 불러오고 있어요.</div>
			</div>
			<div id="modal_one_lego_loading_btn" class="modal_one_btn">
				<p>확인</p></div>
		</div>
	</div>

</div>

<footer id="footer">
	<div class="bottom_common">
		<div id="pre_page">
			<p>
				이전
			</p>
		</div>
		<div id="next_page" align="center">
			<p>
				저장
			</p>
		</div>
	</div>
</footer>

<script type="text/javascript">
  $('input[type=text]').addClass('placeholder');

  //key press event
  $('.user_profile_start_message').keydown(function (key) {
    $('.user_profile_start_message').addClass('transparent');
  });

	$('.user_profile_not_ready_mesage').keydown(function (key) {
    $('.user_profile_not_ready_mesage').addClass('transparent');
  });

  $('.user_profile_skill_info_01').keydown(function (key) {
    $('.user_profile_skill_info_01').addClass('transparent');
  });

  $('.user_profile_skill_info_02').keydown(function (key) {
    $('.user_profile_skill_info_02').addClass('transparent');
  });

  $('.user_profile_skill_info_03').keydown(function (key) {
    $('.user_profile_skill_info_03').addClass('transparent');
  });

  $('.user_profile_self_introduction_01').keydown(function (key) {
    $('.user_profile_self_introduction_01').addClass('transparent');
  });


	var baseInfo_name = `<%=jsonData.baseInfo_name%>`;
	var baseInfo_context = `<%=jsonData.baseInfo_context%>`;

	console.log('baseInfo_name=>' + baseInfo_name +
		'baseInfo_context=>' + baseInfo_context);

  var portfolioList = [];

  var login_logo = $('#login_logo');
  var login_name = $('#login_name_text');
  var login_dropdown = $('#login_dropdown');

  var img_url;

  $.ajax({
    url: 'https://www.chatbrick.io/api/login/',
    type: 'GET',
    async: false,
    crossDomain: true,
    xhrFields: {withCredentials: true},
    success: function (body, status, res) {
      if (body.success) {
        login_logo.attr("src", body.facebook.fb_profile);
        login_name.text(body.facebook.fb_name);
      }
    }
  });


  var upload = document.getElementById('uploadBtn'),
    profile_img = document.getElementById('profile_img');

  var user_profile_photo_upload_btn = $('.user_profile_photo_upload_btn');
  var after_upload = $('#after_upload');
  var after_upload_motify = $('#after_upload_motify');
  var after_upload_del = $('#after_upload_del');
  var imgTmpFile = $('#file');

  imgTmpFile.hide();
  after_upload.hide();

  upload.onchange = function (e) {
    e.preventDefault();

    var file = upload.files[0],
      reader = new FileReader();

    console.log('file=>' + file);
    reader.onload = function (event) {
      var img = new Image();
      img.src = event.target.result;
      if (img.width > 142) { // profile_img width
        img.width = 142;
      }
      if (img.height > 32) {
        img.height = 32;
      }

      profile_img.src = img.src;

      //upload img file api
      var fd = new FormData();
      var uploadFile = $('#profile_img')[0].file;
      console.log('uploadFile=>' + uploadFile);
      fd.append('file', file);

      //TODO: testcode
      // user_profile_photo_upload_btn.hide();
      // after_upload.show();

      $.ajax({
        url: 'https://www.chatbrick.io/api/file/',
        type: 'POST',
        async: false,
        crossDomain: true,
        contentType: false,
        data: fd,
        processData: false,
        success: function (body, status, res) {
          if (body.success) {
            img_url = body.data.url;
            console.log('upliad success!');
            console.log('res img url=>' + img_url);

            user_profile_photo_upload_btn.hide();
            after_upload.show();
          }
        }
      });

    };
    reader.readAsDataURL(file);
  };

  $('#file').change(function (e) {
    e.preventDefault();

    var file = this.files[0];
    var reader = new FileReader();

    reader.onload = function (event) {
      var img = new Image();
      img.src = event.target.result;
      if (img.width > 142) { // profile_img width
        img.width = 142;
      }
      if (img.height > 32) {
        img.height = 32;
      }

      profile_img.src = img.src;

      //upload img file api
      var fd = new FormData();
      var uploadFile = $('#profile_img')[0].file;
      console.log('uploadFile=>' + uploadFile);
      fd.append('file', file);

      //TODO: testcode
//       user_profile_photo_upload_btn.hide();
//       after_upload.show();

      $.ajax({
        url: 'https://www.chatbrick.io/api/file/',
        type: 'POST',
        async: false,
        crossDomain: true,
        contentType: false,
        data: fd,
        processData: false,
        success: function (body, status, res) {
          if (body.success) {
            img_url = body.data.url;
            console.log('upliad success!');
            console.log('res img url=>' + img_url);

            user_profile_photo_upload_btn.hide();
            after_upload.show();
          }
        }
      });
    }
    reader.readAsDataURL(file);
  })

  after_upload_motify.click(function () {
    $('#file').click();
  });

  var animData = {
    wrapper: document.querySelector('#animationWindow'),
    animType: 'svg',
    loop: true,
    prerender: true,
    autoplay: true,
    path: 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/35984/LEGO_loader.json'
  };
  var anim = bodymovin.loadAnimation(animData);
  anim.setSpeed(3.4);

  var lego_loading_modal = document.getElementById('lego_loading_modal');
  var modal_one_lego_loading_btn = $('#modal_one_lego_loading_btn');
  modal_one_lego_loading_btn.css('background-color', '#c0c0c0');


  var loading_click_error_handler = function() {
    lego_loading_modal.style.display = "none";

    //팝업 초기화
    $('#lego_loading_title').text('{{프로젝트명}} 포트폴리오');
    $('#lego_loading_context_01').text('{{프로젝트명}}의 포트폴리오를 읽어오고 있어요.');
    $('#lego_loading_context_02').text('지금 {{순서}}. {{포트폴리오명}}의 정보를 불러오고 있어요.');
    $('#modal_one_lego_loading_btn').css('background-color', '#c0c0c0');
    $('#modal_one_lego_loading_btn').off('click');
    portfolioList = [];
  }

  var loading_click_handler = function() {
    lego_loading_modal.style.display = "none";

    sendDataInServer(portfolioList);
  };

  function sendDataInServer(portfolioList) {
    if (portfolioList != undefined) {
      console.log('portfolioList=>' + JSON.stringify(portfolioList));
      var user_profile_data_name =$('#user_profile_data_name').val();
      var user_profile_data_professional =$('#user_profile_data_professional').val();
      var user_profile_data_location =$('#user_profile_data_location').val();
      var user_profile_data_appeal = $('#user_profile_data_appeal').val();
      var user_profile_data_email = $('#user_profile_data_email').val();

      var user_profile_start_message_01 = $('#user_profile_start_message_01').val();
      var user_profile_start_message_02 = $('#user_profile_start_message_02').val();
      var user_profile_start_message_03 = $('#user_profile_start_message_03').val();
      var user_profile_start_message_result = user_profile_start_message_01 + user_profile_start_message_02 + user_profile_start_message_03;

      var user_profile_not_ready_mesage_01 = $('#user_profile_not_ready_mesage_01').val();
      var user_profile_not_ready_mesage_02 = $('#user_profile_not_ready_mesage_02').val();
      var user_profile_not_ready_mesage_03 = $('#user_profile_not_ready_mesage_03').val();
      var user_profile_not_ready_mesage_result = user_profile_not_ready_mesage_01 + user_profile_not_ready_mesage_02 + user_profile_not_ready_mesage_03;

      var user_profile_company_name_01 = $('#user_profile_company_name_01').val();
      var user_profile_company_name_02 = $('#user_profile_company_name_02').val();
      var user_profile_company_name_03 = $('#user_profile_company_name_03').val();

      var user_profile_company_term_01 = $('#user_profile_company_term_01').val();
      var user_profile_company_term_02 = $('#user_profile_company_term_02').val();
      var user_profile_company_term_03 = $('#user_profile_company_term_03').val();

      var user_profile_company_major_01 = $('#user_profile_company_major_01').val();
      var user_profile_company_major_02 = $('#user_profile_company_major_02').val();
      var user_profile_company_major_03 = $('#user_profile_company_major_03').val();

      var user_profile_skill_name_01 = $('#user_profile_skill_name_01').val();
      var user_profile_skill_name_02 = $('#user_profile_skill_name_02').val();
      var user_profile_skill_name_03 = $('#user_profile_skill_name_03').val();

      var user_profile_skill_info_01_1 = $('#user_profile_skill_info_01_1').val();
      var user_profile_skill_info_01_2 = $('#user_profile_skill_info_01_2').val();
      var user_profile_skill_info_01_result = user_profile_skill_info_01_1 + user_profile_skill_info_01_2;

      var user_profile_skill_info_02_1 = $('#user_profile_skill_info_02_1').val();
      var user_profile_skill_info_02_2 = $('#user_profile_skill_info_02_2').val();
      var user_profile_skill_info_02_result = user_profile_skill_info_02_1 + user_profile_skill_info_02_2;

      var user_profile_skill_info_03_1 = $('#user_profile_skill_info_03_1').val();
      var user_profile_skill_info_03_2 = $('#user_profile_skill_info_03_2').val();
      var user_profile_skill_info_03_result = user_profile_skill_info_03_1 + user_profile_skill_info_03_2;


      var user_profile_self_introduction_01_1 = $('#user_profile_self_introduction_01_1').val();
      var user_profile_self_introduction_01_2 = $('#user_profile_self_introduction_01_2').val();
      var user_profile_self_introduction_01_3 = $('#user_profile_self_introduction_01_3').val();
      var user_profile_self_introduction_01_4 = $('#user_profile_self_introduction_01_4').val();
      var user_profile_self_introduction_01_5 = $('#user_profile_self_introduction_01_5').val();
      var user_profile_self_introduction_01_result = user_profile_self_introduction_01_1 +'\n' + user_profile_self_introduction_01_2 +'\n'
        + user_profile_self_introduction_01_3 +'\n' + user_profile_self_introduction_01_4 +'\n' + user_profile_self_introduction_01_5;

      console.log('user name->' + $('#user_profile_data_name').val());

      var submitData = {
        "type": "designer_portfolio",
        "name": baseInfo_name,
        "desc": baseInfo_context,
        "data": {
          "basic": {
            "profile_image": img_url,
            "name": user_profile_data_name,
            "special": user_profile_data_professional,
            "residence": user_profile_data_location,
            "social": user_profile_data_appeal,
            "email": user_profile_data_email
          },
          "custom_settings": {
            "get_started": user_profile_start_message_result,
            "error_msg": user_profile_not_ready_mesage_result
          },
          "work": [
//            {
//            "name": user_profile_company_name_01,
//            "period": user_profile_company_term_01,
//            "field": user_profile_company_major_01
//          }, {
//            "name": user_profile_company_name_02,
//            "period": user_profile_company_term_02,
//            "field": user_profile_company_major_02
//          }, {
//            "name": user_profile_company_name_03,
//            "period": user_profile_company_term_03,
//            "field": user_profile_company_major_03
//          }
          ],
          "specialties": [
          //   {
          //   "name": user_profile_skill_name_01,
          //   "detail": user_profile_skill_info_01_result
          // }, {
          //   "name": user_profile_skill_name_02,
          //   "detail": user_profile_skill_info_02_result
          // }, {
          //   "name": user_profile_skill_name_03,
          //   "detail": user_profile_skill_info_03_result
          // }
          ],
          "summary": user_profile_self_introduction_01_result,
          "portfolio": portfolioList
//        "portfolio": ["https://www.chatbrick.io", "https://www.naver.com"]
        }
      }

      for (var i = 1; i <=3; i ++) {

        if ($('#user_profile_company_name_0'+i).val() != ''
          && $('#user_profile_company_term_0'+i).val() != ''
          && $('#user_profile_company_major_0'+i).val() != '') {
          submitData.data.work.push(
            {"name": $('#user_profile_company_name_0'+i).val(),
              "period": $('#user_profile_company_term_0'+i).val(),
              "field": $('#user_profile_company_major_0'+i).val()
            })
        }
      }

      for (var i = 1; i<=3; i ++) {
        if ($('#user_profile_skill_name_0'+i).val() != ''
          && $('#user_profile_skill_info_0'+i+'_1').val() != '') {

          var user_profile_skill_info__1 = $('#user_profile_skill_info_0'+i+'_1').val();
          var user_profile_skill_info__2 = $('#user_profile_skill_info_0'+i+'_2').val();
          var user_profile_skill_info_result = user_profile_skill_info__1 + '\n' + user_profile_skill_info__2;

          submitData.data.specialties.push(
            {"name": $('#user_profile_skill_name_0'+i).val(),
              "detail": user_profile_skill_info_result
            }
          )
        }
      }

      if (submitData.data.basic.name =='' || submitData.data.basic.email ==''
        || submitData.data.basic.special =='' || submitData.data.basic.residence ==''
        || submitData.data.basic.social =='') {
        portfolioList = [];
        console.log('in popup')
        var default_modal = document.getElementById('default_modal');
        var modal_one_btn = $('#modal_one_btn');

        default_modal.style.display = "block";

        modal_one_btn.hover(function () {
          $(this).css('background-color', '#fb7c7e');
        }, function () {
          $(this).css('background-color', '#ff753c');
        });

        modal_one_btn.click(function () {
          default_modal.style.display = "none";
        });
      } else {
        portfolioList = [];
        $.ajax({
          url: 'https://www.chatbrick.io/api/brick/',
          type: 'PUT',
          async: false,
          crossDomain: true,
          contentType: 'application/json',
          dataType: 'JSON',
          data: JSON.stringify(submitData),
          success: function (body, status, res) {
            if (body.success) {
              console.log('upload success!');

              var setId = body.data.id;
              window.location.href = '/platform/connect' + '?setId=' + setId;
            }
          }
        });
      }

    } else {
      console.log('portfolioList=> 없음');
    }
  }

  var pre_page = $('#pre_page');
  var next_page = $('#next_page');

  pre_page.click( function () {
    $(this).css('background-color','#bd292c');
    window.location.href = '/chatbot/create';

  });

  next_page.click( function () {
    $(this).css('background-color','#bd292c');
    lego_loading_modal.style.display = "block";

    var designer_portfolio_url_list = [];
    var user_profile_portfolio_01 = $('#user_profile_portfolio_01').val();
    var user_profile_portfolio_02 = $('#user_profile_portfolio_02').val();
    var user_profile_portfolio_03 = $('#user_profile_portfolio_03').val();
    var user_profile_portfolio_04 = $('#user_profile_portfolio_04').val();
    var user_profile_portfolio_05 = $('#user_profile_portfolio_05').val();
    var user_profile_portfolio_06 = $('#user_profile_portfolio_06').val();
    var user_profile_portfolio_07 = $('#user_profile_portfolio_07').val();
    var user_profile_portfolio_08 = $('#user_profile_portfolio_08').val();
    var user_profile_portfolio_09 = $('#user_profile_portfolio_09').val();
    var user_profile_portfolio_10 = $('#user_profile_portfolio_10').val();

    designer_portfolio_url_list.push(user_profile_portfolio_01,user_profile_portfolio_02,
      user_profile_portfolio_03,user_profile_portfolio_04,user_profile_portfolio_05,
      user_profile_portfolio_06,user_profile_portfolio_07,user_profile_portfolio_08,
      user_profile_portfolio_09, user_profile_portfolio_10)

    getAllImages(designer_portfolio_url_list, 10);
  });

  pre_page.hover(function () {
    $(this).css('background-color','#fb7c7e');
  }, function () {
    $(this).css('background-color','#ff753c');
  });

  next_page.hover(function () {
    $(this).css('background-color','#fb7c7e');
  }, function () {
    $(this).css('background-color','#fd6246');
  });


  function statusChangeCallback(response) {
    console.log('statusChangeCallback');
    console.log(response);
    if (response.status === 'connected') {
      console.log('connected!')
      // alert('connected!2');
      // getFBAPI();
//      window.location.href = '/chatbot/list';

    } else if (response.status === 'not_authorized') {
      console.log('not_authorized!')
      window.location.href  = '/';
      // window.location.href = 'http://www.localhost:3000';
    } else {
      console.log('connected error!')
      window.location.href  = '/';
      // window.location.href = 'http://www.localhost:3000';
    }
  }

  //logout event
  var logout_modal = document.getElementById('logout_modal');
  var modal_left_logout_btn = $('#modal_left_logout_btn');
  var modal_right_logout_btn = $('#modal_right_logout_btn');

  login_dropdown.click(function () {
    logout_modal.style.display = "block";
  });

  modal_left_logout_btn.hover(function () {
    $(this).css('background-color', '#fb7c7e');
  }, function () {
    $(this).css('background-color', '#ff753c');
  });

  modal_right_logout_btn.hover(function () {
    $(this).css('background-color', '#fb7c7e');
  }, function () {
    $(this).css('background-color', '#fd6246');
  });

  modal_left_logout_btn.click(function () {
    logout_modal.style.display = "none";
  });

  modal_right_logout_btn.click(function () {
    FB.logout(function(response) {
      console.log('logout=>' + JSON.stringify(response));
      window.location.href = '/';
    });
  });


  function getAllImages(list, maxCount) {
    var count = 0;
    var query = '';
    var queryList = [];
    queryList = list;

    console.log('designer_portfolio_url_list=>' + JSON.stringify(queryList));
    modal_one_lego_loading_btn.off('click');
    modal_one_lego_loading_btn.off('hover');

    function getNextImage(count) {
      query = queryList[count];
      console.log('query=>' + query);

      setTimeout(function() {
      if (query == '') {
        console.log('query는 null입니다');

        count ++;

        if (count == maxCount) {
          console.log('확인 버튼 활성화');

          //확인 누르면 서버에 데이터 전송
          $('#lego_loading_title').text($('#baseInfo_name').val() + '포트폴리오');
          $('#lego_loading_context_01').text($('#baseInfo_name').val() + '의 포트폴리오를 읽어오고 있어요.');
          $('#lego_loading_context_02').text('포트폴리오를 모두 불러왔어요.');
          $('#modal_one_lego_loading_btn').css('background-color', '#ff753c');

          $("#modal_one_lego_loading_btn").bind( "click", loading_click_handler);

        } else {
          getNextImage(count);
        }

      } else {
          $.ajax({
            url: 'https://www.chatbrick.io/api/meta/?url='+ queryList[count],
            method: 'GET',
            async: true,
            success: function(body) {
              count++;
              console.log('count=>' + count);
              console.log('queryList[count]=>' + queryList[count]);
              console.log('body=>' + JSON.stringify(body));

              if (body.success == true && count <= maxCount) {
                console.log('body.data.title=>' + body.data.title);
                portfolioList.push(body.data);

                //마지막에 "확인"버튼 활성화
                if (count == maxCount) {
                  console.log('확인 버튼 활성화');

                  //확인 누르면 서버에 데이터 전송
                  $('#lego_loading_title').text(baseInfo_name + '포트폴리오');
                  $('#lego_loading_context_01').text(baseInfo_name + '의 포트폴리오를 읽어오고 있어요.');
                  $('#lego_loading_context_02').text('지금 '+count+'. '+body.data.title + '의 정보를 불러오고 있어요.');

                  setTimeout(function() {
                  $('#lego_loading_context_02').text('포트폴리오를 모두 불러왔어요.');
                  $('#modal_one_lego_loading_btn').css('background-color', '#ff753c');
                  $("#modal_one_lego_loading_btn").bind( "click", loading_click_handler);
                  }, 500);

                } else {
                  $("#modal_one_lego_loading_btn").unbind( "click", loading_click_handler);
                  $("#modal_one_lego_loading_btn").unbind( "click", loading_click_error_handler);

                  $('#lego_loading_title').text(baseInfo_name + '포트폴리오');
                  $('#lego_loading_context_01').text(baseInfo_name + '의 포트폴리오를 읽어오고 있어요.');
                  $('#lego_loading_context_02').text('지금 '+count+'. '+body.data.title + '의 정보를 불러오고 있어요.');
                  $('#modal_one_lego_loading_btn').css('background-color', '#c0c0c0');
                  getNextImage(count);
                }

//              getNextImage(count);
              } else {
                //error
                //"확인"버튼 클릭가능한 상태
                $('#modal_one_lego_loading_btn').css('background-color', '#ff753c');
                $("#modal_one_lego_loading_btn").bind( "click", loading_click_error_handler);
                $('#lego_loading_context_02').text('지금 '+count+'. '+'번째 포트폴리오의 정보를 불러오는데 실패했어요.');
                $('#user_profile_portfolio_0'+count).val('').end();
                $('#user_profile_portfolio_0'+count).addClass('placeholder');


              }
            }
          });

      } //else
      }, 500);
    }
    getNextImage(count);
  }
</script>
<script type="text/javascript" src="/public/javascripts/connect_facebook.js"></script>
<script type="text/javascript" src="/public/javascripts/footer_mouseover.js"></script>
</body>
</html>