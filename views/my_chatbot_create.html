<!DOCTYPE html>
<html lang="kr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>ChatBrick</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  <!--<script src="../secret/config.js"></script>-->
  <script src="../public/javascripts/config.js"></script>
  <script type="text/javascript" src="/public/javascripts/send_time_log.js"></script>
  <script type="text/javascript" src="/public/javascripts/href_event.js"></script>
  <link rel="stylesheet" href="../public/stylesheets/style.css">
  <!--<script type="text/javascript" src="/public/routes/bricks.js"></script>-->
</head>
<body>
<header id="header">
  <div class="wrapper wrapper_header">
    <div class="top_01 top_common">
      <img id="logo" class="logo" src="../public/images/img-chatbrick-logo.png" alt="logo">

      <div class="top_01 top_user_profile_common">
        <img id="login_logo" class="login_logo">
        <div id="login_name" class="login_name" name="login_name"><p id="login_name_text"></p></div>
        <img id="login_dropdown" class="login_dropdown" src="../public/images/btn-dropdown-down.png" alt="login_dropdown">
      </div>
    </div>

    <div class="top_02 top_common">
      <div class="top_02 title_area">
        <div id="title">CREAT CHATBOT</div>
        <div id="sub_title">| 기본정보 입력 및 선택</div>
      </div>
      <div id="context">
        <p>
          챗봇 생성 첫번째 단계로 생성하려는 챗봇의 이름, 설명을 입력하고 봇에 적용할 세트를 선택할 수 있어요.<br>
          세트 선택하기 버튼 옆의 “미리보기” 버튼을 클릭하여 해당 세트를 체험해 볼 수 있어요.
        </p>
      </div>
    </div>
  </div>
</header>

<div id="content">
  <div class="wrapper_section _baseInfo_section">
    <section id="section_01">
      <div class="content_title">
        <p>
          기본정보
        </p>
      </div>

      <div class="wrapper_article _baseInfo_wrapper">
        <article id="article_01" class="_article">

          <div class="wrapper">
            <div class="baseInfo_01 article_title">
              <p>
                챗봇 이름
              </p>
            </div>
            <input type="text" id="baseInfo_name" class="baseInputText" placeholder="생성하려는 챗봇의 이름을 입력해주세요. (최대8자)" maxlength="8">

            <div class="baseInfo_02 article_title">
              <p>
                챗봇 설명
              </p>
            </div>
            <input type="text" id="baseInfo_context_01" class="baseInputText baseInfo_placeHolder testInput" placeholder="생성하려는 챗봇의 설명문구를 입력해주세요." maxlength=50>
            <input type="text" id="baseInfo_context_02" class="baseInputText baseInfo_placeHolder testInput" maxlength=50>

          </div>
        </article>
      </div>
    </section>
  </div>

  <div class="wrapper_section _choice_set_section">
    <section id="section_02">
      <div class="content_title">
        <p>
          SET 선택
        </p>
      </div>

      <div class="wrapper_article _choice_set_wrapper">
        <article id="article_02" class="_article">
          <div class="wrapper">
            <div class="set_list" id="set_list">
              <!--item hackathon-->
              <div id="set_hackathon" class="set_item">
                <img src="../public/images/img-hackathon.png"
                     id="hackathon_image" class="set_item_img" alt="set image">
                <div id="hackathon_name" class="set_item_name">
                  <p>HACKATHON</p>
                </div>
                <div id="hackathon_context" class="set_item_context">
                  <p>
                    해커톤을 운영하면서 필요한 참여자 모집 ,
                    행사정보 안내, 후원사모집 등의 다양한
                    업무를 보조하는 챗봇 세트
                  </p>
                </div>

                <div class="set_item_event">
                  <div id="hackathon_choice" class="set_choice">
                      세트선택하기
                  </div>
                  <div id="hackathon_preview" class="set_preview">
                    <img src="../public/images/btn-preview-01-nor.png"
                         alt="preview_img">
                  </div>
                </div>
              </div>

              <!--item designer portfolio-->
              <div id="set_designer_portfolio" class="set_item">
                <img src="../public/images/img-designer-portfolio-01.png"
                     id="designer_portfolio_image" class="set_item_img" alt="set image">
                <div id="designer_portfolio_name" class="set_item_name">
                  <p>DESIGNER
                    PORTFOLIO</p>
                </div>
                <div id="designer_portfolio_context" class="set_item_context">
                  <p>
                    디자이너가 자신의 포트폴리오 및
                    이력서를 알리기 위한 챗봇 세트
                  </p>
                </div>

                <div class="set_item_event">
                  <div id="designer_portfolio_choice" class="set_choice">
                      세트선택하기
                  </div>
                  <div id="designer_portfolio_preview" class="set_preview">
                    <img src="../public/images/btn-preview-01-nor.png"
                         alt="preview_img">
                  </div>
                </div>
              </div>

              <!--item bricks-->
              <div id="set_bricks" class="set_item">
                <img src="../public/images/img-bricks.png"
                     id="bricks_image" class="set_item_img" alt="set image">
                <div id="bricks_name" class="set_item_name">
                  <p>BRICKS</p>
                </div>
                <div id="bricks_context" class="set_item_context">
                  <p>
                    CHATBRICK에서 지원하는 다양한 브릭들을
                    조합하여 자신에게 필요한 챗봇을 제작할 수 있는 세트
                  </p>
                </div>

                <div class="set_item_event">
                  <div id="bricks_choice" class="set_choice">
                      세트선택하기
                  </div>
                  <div id="bricksn_preview" class="set_preview">
                    <img src="../public/images/btn-preview-01-nor.png"
                         alt="preview_img">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </article>
      </div>
    </section>
  </div>

  <!--디바이스 모양 팝업-->

  <div id="modal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">

      <div class="modal_device_wapper">

        <div class="device_img">
          <img src="../public/images/gif_b03.gif" id="modal_device_img">
          <img src="../public/images/img-device1.png" id="landing_device_img">
        </div>
        <!--<img src="../public/images/img-device.png" id="modal_device_img" class="device_img">-->
        <div class="modal_device_content">
          <div class="modal_device_set_content">

            <div class="modal_device_set_title_area">
              <div class="modal_device_set_title">
                | SET DEMO
              </div>
              <div class="modal_device_set_kind_name" id="modal_device_set_kind_name">
                HACKATHON
              </div>
            </div>
            <img src="../public/images/img-hackathon.png" class="modal_device_set_kind_img" id="modal_device_set_kind_img">
          </div>

          <!--<hr class="modal_device_underline">-->
          <div class="modal_device_context_desc" id="modal_device_context_desc">
            Build a Facebook bot without coding. Launch a full-featured <br>
            chatbot in 7 minutes. We believe in the power of chatbots to<br>
            strengthen your connection to your audience—whether <br>
            that's your customers, readers, fans, or others. <br>
            And we're committed to making that as easy as we can.
          </div>
        </div>

        <img src="../public/images/btn-close-nor.png" id="close_modal_img" class="close_modal_img">
      </div>
    </div>
  </div>

  <!--디폴트 모양 팝업-->
  <div id="default_modal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">

      <div class="modal_title">확인</div>
      <div class="modal_context">올바르지 않은 항목이 존재합니다. (미입력, 잘못입력된 항목)</div>
      <div id="modal_one_btn" class="modal_one_btn">
        <p>확인</p></div>
    </div>
  </div>
</div>

<!--로그아웃 모양 팝업-->
<div id="logout_modal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">

    <div class="modal_title">로그아웃</div>
    <div class="modal_context">chatbrick에서 로그아웃하시겠어요?</div>
    <div class="modal_brick_api_two_btn_area">
      <div id="modal_left_logout_btn" class="modal_left_btn">
        <p>아니요</p>
      </div>

      <div id="modal_right_logout_btn" class="modal_right_btn">
        <p>네</p>
      </div>
    </div>
  </div>
</div>

<footer id="footer">
  <div class="bottom_common">
    <div id="pre_page">
      <p>
        봇 생성 취소
      </p>
    </div>
    <div id="next_page">
      <p>
        다음
      </p>
    </div>
  </div>
</footer>

<script type="text/javascript">

  $.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if (results==null){
      return null;
    }
    else{
      return results[1] || 0;
    }
  }

  var start_time_set_click = '';
  var start_time_create_bot_click = '';
  var start_time_page = '';
  var end_time_page = '';

  var log_id_page = '';

  $(document).ready(function() {
    //check start time
    var date = new Date();
    start_time_page = date.getTime();
    log_id_page = 'create_bot' + start_time_page;

    start_time_create_bot_click = $.urlParam('start_time_next_btn_click');

    var task_code = 'create_bot';
    var remark = '봇리스트에서 create bot을 선택했을때';
    var api_code = 'create_bot';
    var api_provider_code = 'chatbrick';
    sendAPILog(log_id_page, api_code, api_provider_code, start_time_create_bot_click, start_time_page, remark);

  });

  $(window).load(function() {
    //check end time
    var date = new Date();
    end_time_page = date.getTime();
    var task_code = 'create_bot';
    var remark = '데이터 정보 입력하기 페이지가 로드되었을때';
    var api_code = 'create_bot';
    var api_provider_code = 'chatbrick';
    sendAPILog(log_id_page, api_code, api_provider_code, start_time_page, end_time_page, remark);
    sendTaskLog(log_id_page, task_code, start_time_create_bot_click, end_time_page, remark);
    history.replaceState({}, null, location.pathname);
  });

  $('#logo').click(function () {
    logoClickSendHomeEvent();
  });
  $('input[type=text]').addClass('placeholder');

  var baseInfo_name = $('#baseInfo_name');
  var baseInfo_context;
  var baseInfo_context_01 = $('#baseInfo_context_01');
  var baseInfo_context_02 = $('#baseInfo_context_02');


  //hide placeholder
//  $('.baseInfo_placeHolder').keydown(function (key) {
//    $('.baseInfo_placeHolder').addClass('transparent');
//
//  });

  $('.testInput').keyup (function () {
    var charLimit = $(this).attr("maxlength");
    if (this.value.length >= charLimit) {
      $(this).next('.testInput').focus();
      return false;
    }
  });

  checkForHash();

  function checkForHash() {
    if(document.location.hash){
      var hashLocation = document.location.hash;
      hashLocation = hashLocation.replace("#","");

      var hashValues = hashLocation.split("&");
      var hashName = hashValues[0];
      var hashDesc = hashValues[1].split('\n');
      var hashSet = hashValues[2];
//      var hashDesc2 = hashValues[2];
      console.log('hashName=>' + hashName + 'hashDesc=>' + hashDesc + 'hashSet=>' + hashSet);
      baseInfo_name.text(hashName);
      baseInfo_context_01.text(hashDesc[0]);
      baseInfo_context_02.text(hashDesc[1]);

      if (hashSet != '') {
//        $('#set_list').val(hashSet);
//        hashSet = '';

        if (hashSet == 'hackathon_choice') {

          console.log('in hackathon_choice');

          $('#set_list').val("hackathon_choice");
          $('#hackathon_choice').css('background-color', '#000000');
          $('#hackathon_choice').text('선택해제 하기');
          hashSet = '';

        } else if (hashSet == 'designer_portfolio_choice') {

          console.log('in designer_portfolio_choice');

          $('#set_list').val("designer_portfolio_choice");
          $('#designer_portfolio_choice').css('background-color', '#000000');
          $('#designer_portfolio_choice').text('선택해제 하기');
          hashSet = '';

        } else if (hashSet == 'bricks_choice') {

          console.log('in bricks_choice');

          $('#set_list').val("bricks_choice");
          $('#bricks_choice').css('background-color', '#000000');
          $('#bricks_choice').text('선택해제 하기');
          hashSet = '';

        } else {
          $('#hackathon_choice').css('background-color', '#ff753c');
          $('#designer_portfolio_choice').css('background-color', '#ff753c');
          $('#bricks_choice').css('background-color', '#ff753c');
          $('#hackathon_choice').text('세트선택하기');
          $('#designer_portfolio_choice').text('세트선택하기');
          $('#bricks_choice').text('세트선택하기');
        }
      }

      document.location.hash = '';
    } else {
      console.log('no hash!');

      baseInfo_name.val('');
      baseInfo_context_01.val('');
      baseInfo_context_02.val('');

    }
  }

  var login_logo = $('#login_logo');
  var login_name = $('#login_name_text');
  var login_dropdown = $('#login_dropdown');

  $.ajax({
    url: 'https://www.chatbrick.io/api/login/',
    type: 'GET',
    async: false,
    crossDomain: true,
    xhrFields: {withCredentials: true},
    success: function (body, status, res) {
      if (body.success) {
        login_logo.attr("src", body.facebook.fb_profile);
        login_name.text(body.facebook.fb_name);
      }
    }
  });

  var set_list = $('#set_list');
  var set_hackathon = $('#set_hackathon');
  var set_designer_portfolio = $('#set_designer_portfolio');
  var set_bricks = $('#set_bricks');
  var set_preview = $('.set_preview');
  var modal_device_set_kind_name = $('#modal_device_set_kind_name');
  var modal_device_context_desc = $('#modal_device_context_desc');

  var hackathon_choice = $('#hackathon_choice');
  var designer_portfolio_choice = $('#designer_portfolio_choice');
  var bricks_choice = $('#bricks_choice');
  var pre_page = $('#pre_page');
  var next_page = $('#next_page');

  set_preview.click(function () {
    var itemIndex = $(this).parent().parent().index();
    console.log('itemIndex=>' + itemIndex);
//    $(this).toggleClass("press");
    modal.style.display = "block";

    if (itemIndex == '0') {
      modal_device_set_kind_name.text('HACKATHON');
      modal_device_context_desc.text('해커톤을 운영하고 계신가요? 몇가지 필요한 정보들을 입력하면 운영하는 해커톤의 일정 및 장소, 참가요건, 시상 및 참가혜택, 참가신청 홈페이지로 이동, 이메일로 문의, 주최/주관/후원처에 대한 안내를 할 수 있어요.');
      $('#modal_device_img').attr("src", '../public/images/gif_s01.gif');
      $('#modal_device_set_kind_img').attr("src", '../public/images/img-hackathon.png');

    } else if (itemIndex == '1') {
      modal_device_set_kind_name.text('DESIGNER PORTFOLIO');
      modal_device_context_desc.text('디자이너이신가요? 디자이너 포트폴리오에 필요한 정보들을 입력하면 나를 궁금해하는 사람들에게 보다 효과적으로 소개할 수 있어요. 나의 이름, 전문분야, 거주지역, 개인 홈페이지, 경력사항, 스킬, 포트폴리오, 간단한 자기소개에 대한 안내를 할 수 있어요.')
      $('#modal_device_img').attr("src", '../public/images/gif_s02.gif');
      $('#modal_device_set_kind_img').attr("src", '../public/images/img-designer-portfolio-01.png');
    } else if (itemIndex == '2') {
      modal_device_set_kind_name.text('BRICKS');
      modal_device_context_desc.text('나만을 위한 챗봇을 원하시나요? 20개의 BRICK 중 최대 10개를 선택하여 챗봇에 적용할 수 있어요. BRICK에는 열차조회, 습득물조회, 메일보내기, 로또당첨번호, 해외국가정보, 우체국택배, 공공취업정보, 우편번호찾기, 오늘의운세, 응급실검색, 쉬는날검색, 해외SOS, 인천출국장, 전기차충전소, 여행경보조회, 얼마나닮았지, 내기분어때,  스타일렌즈, 자소서분석, 누구냐넌이 있어요.');
      $('#modal_device_img').attr("src", '../public/images/gif_b18.gif');
      $('#modal_device_set_kind_img').attr("src", '../public/images/img-bricks.png');
    }
  });

  close_modal_img.onclick = function () {
    modal.style.display = "none";
  }


  set_preview.hover(function () {
    $(this).css('background-color', '#fb7c7e');
  }, function () {
    $(this).css('background-color', '#e94d50');
  });


  hackathon_choice.click(function () {
    set_list.val("hackathon_choice");
    $(this).css('background-color', '#000000');
    next_page.css('background-color', '#fd6246');
    next_page.hover(function () {
      next_page.css('background-color', '#fb7c7e');
    }, function () {
      next_page.css('background-color', '#fd6246');
    });
     $(this).text('선택해제 하기');

    designer_portfolio_choice.css('background-color', '#ff753c');
     designer_portfolio_choice.text('세트선택하기');
    bricks_choice.css('background-color', '#ff753c');
     bricks_choice.text('세트선택하기');

  });

  designer_portfolio_choice.click(function () {
    set_list.val("designer_portfolio_choice");
    $(this).css('background-color', '#000000');
    next_page.css('background-color', '#fd6246');
    next_page.hover(function () {
      next_page.css('background-color', '#fb7c7e');
    }, function () {
      next_page.css('background-color', '#fd6246');
    });
     $(this).text('선택해제 하기');

    hackathon_choice.css('background-color', '#ff753c');
     hackathon_choice.text('세트선택하기');
    bricks_choice.css('background-color', '#ff753c');
     bricks_choice.text('세트선택하기');
  });


  bricks_choice.click(function () {
    set_list.val("bricks_choice");
    $(this).css('background-color', '#000000');
    next_page.css('background-color', '#fd6246');
    next_page.hover(function () {
      next_page.css('background-color', '#fb7c7e');
    }, function () {
      next_page.css('background-color', '#fd6246');
    });
     $(this).text('선택해제 하기');

    designer_portfolio_choice.css('background-color', '#ff753c');
     designer_portfolio_choice.text('세트선택하기');
    hackathon_choice.css('background-color', '#ff753c');
     hackathon_choice.text('세트선택하기');
  });


  if (set_list.val() != "hackathon_choice"
    && set_list.val() != "designer_portfolio_choice"
    && set_list.val() != "bricks_choice") {
    next_page.css('background-color', '#c0c0c0');
  } else {
    next_page.hover(function () {
      next_page.css('background-color', '#fb7c7e');
    }, function () {
      next_page.css('background-color', '#fd6246');
    });
  }

  pre_page.click(function () {
    $(this).css('background-color', '#bd292c');
    window.location.href = '/chatbot/list';
  });
  pre_page.hover(function () {
    pre_page.css('background-color', '#fb7c7e');
  }, function () {
    pre_page.css('background-color', '#ff753c');
  });


  next_page.click(function () {
    $(this).css('background-color', '#bd292c');

    //check start time
    var date = new Date();
    start_time_set_click = date.getTime();

    var hashData = baseInfo_name.val() + '&' + baseInfo_context_01.val() + '\n' + baseInfo_context_02.val();
    var request_query = '?baseInfo_name='+baseInfo_name.val()+'&baseInfo_context='+baseInfo_context_01.val() + '\n' + baseInfo_context_02.val();
    var set_list_query = '&set_list_query=';
    var start_time_next_btn_click = '&start_time_next_btn_click=';

    console.log('request_query=>' + request_query);

    if (set_list.val() != '' &&(baseInfo_name.val() == '')) {
      console.log('in popup')
      var default_modal = document.getElementById('default_modal');
      var modal_one_btn = $('#modal_one_btn');

      default_modal.style.display = "block";

      modal_one_btn.hover(function () {
        $(this).css('background-color', '#fb7c7e');
      }, function () {
        $(this).css('background-color', '#ff753c');
      });

      modal_one_btn.click(function () {
        default_modal.style.display = "none";
      });
    } else {
      if (set_list.val() == "hackathon_choice") {

        window.location.href = '/hackathon/create' + request_query + set_list_query + set_list.val();
        document.location.hash = hashData+ '&' + set_list.val();

      } else if (set_list.val() == "designer_portfolio_choice") {
        // console.log(request_query);
        window.location.href = '/designerPortfolio/create' + request_query + set_list_query + set_list.val() + start_time_next_btn_click + start_time_set_click;
        document.location.hash = hashData+ '&' + set_list.val();

      } else if (set_list.val() == "bricks_choice") {

        window.location.href = '/bricks/create' + request_query + set_list_query + set_list.val() + start_time_next_btn_click + start_time_set_click ;
        document.location.hash = hashData+ '&' + set_list.val();

      } else {
        next_page.css('background-color', '#c0c0c0');
      }
    }
  });

  function statusChangeCallback(response) {
    console.log('statusChangeCallback');
    console.log(response);
    if (response.status === 'connected') {
      console.log('connected!')
      // alert('connected!2');
      // getFBAPI();
//      window.location.href = '/chatbot/list';

    } else if (response.status === 'not_authorized') {
      console.log('not_authorized!')
      window.location.href  = '/';
      // window.location.href = 'http://www.localhost:3000';
    } else {
      console.log('connected error!')
      window.location.href  = '/';
      // window.location.href = 'http://www.localhost:3000';
    }
  }

  //logout event
  var logout_modal = document.getElementById('logout_modal');
  var modal_left_logout_btn = $('#modal_left_logout_btn');
  var modal_right_logout_btn = $('#modal_right_logout_btn');

  login_dropdown.click(function () {
    logout_modal.style.display = "block";
  });

  modal_left_logout_btn.hover(function () {
    $(this).css('background-color', '#fb7c7e');
  }, function () {
    $(this).css('background-color', '#ff753c');
  });

  modal_right_logout_btn.hover(function () {
    $(this).css('background-color', '#fb7c7e');
  }, function () {
    $(this).css('background-color', '#fd6246');
  });

  modal_left_logout_btn.click(function () {
    logout_modal.style.display = "none";
  });

  modal_right_logout_btn.click(function () {
    var start_time_next_btn_click = '?start_time_next_btn_click=';
    //check start time
    var date = new Date();
    var start_time_create_bot_click = date.getTime();

    FB.logout(function(response) {
      console.log('logout=>' + JSON.stringify(response));

      //check end time
      var date = new Date();
      var end_time_page = date.getTime();
      var log_id_page = 'logout_facebook' + start_time_create_bot_click;
      var task_code = 'logout_facebook';
      var remark = '로그아웃 버튼을 클릭후 페이스북에서 로그아웃를 성공적으로 처리했을때';
      var api_code = 'logout_facebook';
      var api_provider_code = 'facebook';
      sendAPILog(log_id_page, api_code, api_provider_code, start_time_create_bot_click, end_time_page, remark);
      window.location.href = '/' + start_time_next_btn_click + start_time_create_bot_click;
    });
  });
</script>
<!--<script type="text/javascript" src="/public/javascripts/connect_facebook.js"></script>-->
<!--<script type="text/javascript" src="/public/javascripts/my_chatbot_create.js"></script>-->
<!--<script type="text/javascript" src="/public/javascripts/footer_mouseover.js"></script>-->
</body>
</html>
